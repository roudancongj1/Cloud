<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="css/ele.css">
    <!--图标-->
    <link rel="shortcut icon" href="img/favicon.ico" >
    <script src="js/vue.global.js"></script>
    <script src="js/element-plus.js"></script>
    <script src="js/axios.min.js"></script>
    <script src="js/vue-router.global.js"></script>
    <style>
        #app{
            width: 100%;
            top: 0;
            left: 0;
            position: absolute;
        }
        body{
            background: #f9f9fa;
        }
        .header {
            padding: 40px;
            text-align: right;
            height: 100px;
        }
        .herderLink {
            margin: 0 20px;
            font-size: 20px;
        }
        .copyright{
            text-align: center;
            position: relative;
            bottom: auto;
        }
        .cont{
            padding: 100px;
        }
        .addInfo{
            margin: 50px 20px;
        }
        .label .el-form-item__label{
            font-family: "Microsoft YaHei UI";
            font-size: 20px;
            color: #606266;
        }
    </style>
</head>
<body>
<div id="app">
    <el-container>
        <el-header class="header">
            <el-affix>
                <el-link class="herderLink" @click="index">首页</el-link>
                <el-link class="herderLink" @click="services">服务</el-link>
                <el-link class="herderLink" @click="city">城市</el-link>
                <el-link class="herderLink" @click="about">关于</el-link>
                <el-link class="herderLink" @click="support">支持我们</el-link>
                <el-link class="herderLink" @click="feedback">反馈</el-link>
                <el-button class="herderLink" @click="toLogin" v-if="visitor" round>登录</el-button>
                <el-dropdown trigger="click" v-else>
                    <el-button class="herderLink" circle>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" class="bi bi-person-lines-fill" viewBox="0 0 16 16">
                            <path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5zm.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1h-4zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2z"/>
                        </svg>
                    </el-button>
                    <template #dropdown>
                        <el-dropdown-menu>
                            <el-dropdown-item @click="toUser">个人资料</el-dropdown-item>
                            <el-dropdown-item @click="toAccount">我的账户</el-dropdown-item>
                            <el-dropdown-item v-if="userRole != '0'" @click="toManage">后台管理</el-dropdown-item>
                            <el-dropdown-item @click="logout" divided>退出登录</el-dropdown-item>
                        </el-dropdown-menu>
                    </template>
                </el-dropdown>
            </el-affix>
        </el-header>
        <el-main>
            <router-view></router-view>
            <!--<img src="img/404.jpg">-->
            <Copyright></Copyright>
        </el-main>

    </el-container>
</div>

<script>
    const Copyright= {
        template: '<div class="copyright">' +
                      '<p>Isolation Hotel selection</p>' +
                      '<p>Copyright © 2022 by Empty seat</p>' +
                  '</div>'
    }

    const App ={
        data(){
            return{
                token: '',
                visitor: true,
                userRole: '',
            }
        },
        methods: {
            index() {
                this.$router.push({ name: 'index' })
            },
            services() {
                this.$router.push({ name: 'services' })
            },
            city() {
                this.$router.push({ name: 'city' })
            },
            about() {
                this.$router.push({ name: 'about' })
            },
            support() {
                this.$router.push({ name: 'support' })
            },
            feedback() {
                this.$router.push({
                    name: 'feedback',
                    params: {
                        id: '3',
                        name: '城市'
                    }
                })
            },
            toLogin() { window.location.href="/toLogin" },
            toUser() { window.location.href="/user" },
            toAccount() {window.location.href="/account" },
            toManage() { window.location.href="/manage"},
            toVisitor() {
                axios({
                    method: 'get',
                    url: 'visitor',
                    headers: {'token': localStorage.getItem('token')}
                }).then(res => {
                    this.visitor = res.data.data
                    if (!res.data.data){
                        axios({
                            method: 'get',
                            url: 'userRole',
                            headers: {'token': localStorage.getItem('token')}
                        }).then(res => {
                            this.userRole = res.data.userRole
                        })
                    }
                })
            },
            logout() {
                axios({
                    method: 'get',
                    url: 'logout',
                    headers: {'token': localStorage.getItem('token')}
                }).then(res => {
                    if (res.data.code === '0'){
                        this.$notify.success({
                            title: '注销成功',
                            message: '请重新登陆'
                        })
                    }else {
                        this.$notify.error({
                            title: '注销失败',
                            message: res.data.msg
                        })
                    }
                    window.setTimeout(function (){window.location.reload()},2*1000)
                })
            }

        },
        created() {
            this.toVisitor()

        },
        watch: {
          // $route(){
          //     this.$route.params.label=this.cards.l
          // },
        },
        mounted() {
            this.token = localStorage.getItem('token')
        },
        components: {
            'Copyright': Copyright
        }
    }

    const index = { template:
            '<el-container class="cont">\n' +
            '    <div>\n' +
            '        <h1 style="font-size: 30px">出差/旅游到疫情地区?</h1>\n' +
            '        <h3>担心隔离的环境脏,乱,差?</h3>\n' +
            '        <p>隔离期间的日日夜夜少不了对亲人的思念，舒适的隔离环境对您显得尤为重要，一起来挑选一个满意的隔离地点吧!</p>\n' +
            '        <router-link to="city"><el-button type="info" round>点击挑选</el-button></router-link>\n' +
            '    </div>\n' +
            '    <img src="img/index1.png">\n' +
            '</el-container>\n' +''
    }

    const services = { template: '<el-container>\n' +
            '                <el-header style="text-align: center">\n' +
            '                    <h1>我们的服务</h1>\n' +
            '                    <el-divider></el-divider>\n' +
            '                </el-header>\n' +
            '                <el-main>\n' +
            '                        <el-container>\n' +
            '                            <el-card v-for="(ser,index) in staticSer" style="margin: 20px;width: 25%">\n' +
            '                                <template #header>\n' +
            '                                    <div>\n' +
            '                                        <span style="color: red;text-decoration: underline">{{ser.staticLabel}}</span>\n' +
            '                                    </div>\n' +
            '                                </template>\n' +
            '                                <div><span style="color: #303133">{{ser.staticValue}}</span></div>\n' +
            '                            </el-card>\n' +
            '                        </el-container>\n' +
            '                        <el-divider></el-divider>\n' +
            '                            <el-container class="cont">\n' +
            '                            <div style="width: 60%"><h3>我们由封闭车辆对您出站第一时间进行闭环转运\n' +
            '                             </h3></div>\n' +
            '                            <img src="img/s1.png ">\n' +
            '                            </el-container>\n' +
            '                        <el-divider></el-divider>\n' +
            '                </el-main>\n' +
            '            </el-container>' + '',
        data(){
            return{
                staticSer: [],
            }
        },
        methods: {
            serviceInfo() {
                axios({
                    method: 'get',
                    url: 'data/static/SERVICE',
                }).then(res => {
                    if (res.data.code === '0') {
                        this.staticSer = res.data.data
                    } else {
                        this.$massage.error(res.data.msg)
                    }
                })
            },
        },
        created(){
            this.serviceInfo()
        }
    }

    const city = {
        template: '<el-carousel height="600px" style="width: 90%;margin: auto">\n' +
            '          <el-carousel-item >\n' +
            '              <img src="img/sh.jpg" style="object-fit: cover;width: 100%;height: 100%">\n' +
            '          </el-carousel-item>\n' +
            '          <el-carousel-item >\n' +
            '              <img src="img/gz.jpg" style="object-fit: cover;width: 100%;height: 100%">\n' +
            '          </el-carousel-item>\n' +
            '          <el-carousel-item >\n' +
            '              <img src="img/bj.jpg" style="object-fit: cover;width: 100%;height: 100%">\n' +
            '          </el-carousel-item>\n' +
            '          <el-carousel-item >\n' +
            '              <img src="img/sz.jpg" style="object-fit: cover;width: 100%;height: 100%">\n' +
            '          </el-carousel-item>\n' +
            '      </el-carousel>\n'+
            '      <el-button @click="downloadForm">下载今日疫情表格</el-button>\n' +
            '      <p>查询</p>\n' +
            '      <p>购买</p>\n' +
            '      <p>支付</p>' + '',
        data(){
            return{

            }
        },
        methods:{
            downloadForm(){
                return
            }
        },
        created(){

        }
    }

    const about = {
        template: '<el-container>\n' +
            '          <el-header style="text-align: center">\n' +
            '              <h1>关于</h1>\n' +
            '          </el-header>\n' +
            '          <el-main>\n' +
            '              <el-container>\n' +
            '                  <div style="width: 50%;text-align: right;padding: 20px" >\n' +
            '                  <div v-for="(abo,index) in staticAbo">\n' +
            '                      <p>{{abo.staticLabel}}</p><el-divider></el-divider>\n' +
            '                  </div>\n' +
            '                  </div>\n' +
            '                  <div style="width: 50%;padding: 20px">\n' +
            '                  <div  v-for="(abo,index) in staticAbo">\n' +
            '                      <p>{{abo.staticValue}}</p><el-divider></el-divider>\n' +
            '                  </div>\n' +
            '                  </div>\n' +
            '              </el-container>\n' +
            '          </el-main>\n' +
            '      </el-container>' + '',
        data() {
          return {
              staticAbo: [],
          }
        },
        methods: {
            aboutInfo() {
                axios({
                    method: 'get',
                    url: 'data/static/ABOUT',
                }).then(res => {
                    if (res.data.code === '0'){
                        this.staticAbo = res.data.data
                        //alert(JSON.stringify(this.staticAbo))
                    }else {
                        this.$message.error(res.data.msg)
                    }
                })
            },
        },
        created() {
            this.aboutInfo()
        }
    }


    const support = {
        template: '<el-empty description="暂时为空" :image-size="300"></el-empty>',
        data() {
            return {
                aa: 'aaaaaa',
            };
        },
        methods: {

        }
    }


    const feedback = {
        template: '<el-container>\n' +
            '          <div style="width: 40%;padding: 10px">\n' +
            '              <el-card>\n' +
            '                  <template #header>\n' +
            '                      <div class="card-header">\n' +
            '                          <h2>我们的联系方式</h2>\n' +
            '                      </div>\n' +
            '                  </template>\n' +
            '                  <h3 class="addInfo">地址:北京市朝阳区百xxxxx</h3>\n' +
            '                  <h3 class="addInfo">电话:181xxxx8872</h3>\n' +
            '                  <h3 class="addInfo">邮箱:Yun_mic@126.com</h3>\n' +
            '                  <h3 class="addInfo">联系人:高xx</h3>\n' +
            '                  <h3 class="addInfo" style="color: #66b1ff">您也可以在右侧在线向我们发送邮件提交您宝贵的建议></h3>\n' +
            '              </el-card>\n' +
            '          </div>\n' +
            '          <div style="width: 60%;padding: 10px">\n' +
            '              <el-form   ref="feedbackFrom"' +
            '                        :model="feedbackFrom" ' +
            '                        :rules="feedbackRule" ' +
            '                        label-position="left" ' +
            '                        label-width="150px" ' +
            '                        status-icon>\n' +
            '                  <el-form-item label="邮箱:" class="label" prop="mail">\n' +
            '                      <el-input placeholder="邮箱" v-model="feedbackFrom.mail"></el-input>\n' +
            '                  </el-form-item>\n' +
            '                  <el-form-item label="地址:" class="label" prop="address">\n' +
            '                      <el-input placeholder="地址" v-model="feedbackFrom.address"></el-input>\n' +
            '                  </el-form-item>\n' +
            '                  <el-form-item label="电话/手机:" class="label" prop="phone">\n' +
            '                      <el-input placeholder="电话" v-model.number="feedbackFrom.phone"></el-input>\n' +
            '                  </el-form-item>\n' +
            '                  <el-form-item label="您的意见:" class="label" prop="text">\n' +
            '                      <el-input type="textarea" ' +
            '                                placeholder="留言" ' +
            '                                rows="13"' +
            '                                v-model="feedbackFrom.text"></el-input>\n' +
            '                  </el-form-item>' +
            '                  <el-divider></el-divider>' +
            '                  <el-button type="primary" style="width: 100%" @click="toFeedback(\'feedbackFrom\')">提交</el-button>\n' +
            '              </el-form>\n' +
            '          </div>\n' +
            '      </el-container>' +'',
        data() {
            return{
                feedbackFrom: {
                    mail: '',
                    address: '',
                    phone: '',
                    text: ''
                },
                feedbackRule: {
                    mail: [
                        { required: true, message: '邮箱不能为空', trigger: 'blur' },
                    ],
                    address: [
                        { required: true, message: '密码不能为空', trigger: 'blur' },
                    ],
                    phone: [
                        { required: true, message: '电话/手机不能为空', trigger: 'blur' },
                        { type: 'number', message: '电话/手机必须为数字' },
                    ],
                    text: [
                        { required: true, message: '意见不能为空', trigger: 'blur' },
                    ]
                },

            }
        },
        methods: {
            toFeedback(feedbackFrom){
                this.$refs.feedbackFrom.validate(valid => {
                    if (valid) {
                        axios({
                            method: 'post',
                            url: 'sendMail',
                            data: {
                                mail: this.feedbackFrom.mail,
                                address: this.feedbackFrom.address,
                                phone: this.feedbackFrom.phone,
                                text: this.feedbackFrom.text,
                            },
                            headers: {'token': localStorage.getItem('token')}
                        }).then(res => {
                            if(res.data.code === '0'){
                                this.$message.success(res.data.msg)
                            }else {
                                this.$message.error(res.data.msg)
                            }
                        })
                    }
                })
            }
        }
    }


    const error = {
        template: '<div style="padding: 100px;text-align: center" ><h1>无效的页面路径^^</h1>' +
            '<img src="img/404p.png"><br><router-link to="index">返回首页</router-link></div>'
    }

    const router = VueRouter.createRouter({
        history: VueRouter.createWebHashHistory(),
        routes: [
            { path: '/:catchAll(.*)', redirect: '/404'},
            { path: '/404', name: '404', component: error },
            { path: '/', redirect: '/index'},
            { path: '/index', name: 'index', component: index },
            { path: '/services', name: 'services', component: services},
            { path: '/city', name: 'city', component: city},
            { path: '/about', name: 'about', component: about},
            { path: '/support', name: 'support', component: support},
            { path: '/feedback', name: 'feedback', component: feedback}

        ]
    })
    Vue.createApp(App)
        .use(router)
        .use(ElementPlus)
        .mount("#app")
</script>
</body>
</html>
